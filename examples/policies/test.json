{
    "schema": {
        "type": "object",
        "required": ["api_method", "ip", "utc_millis", "user_agent", "rr_sets"],
        "additionalProperties": false,
        "properties": {
            "api_method": { "type": "string" },
            "ip": { "type": "string" },
            "utc_millis": { "type": "number" },
            "user_agent": { "type": "string" },
            "rr_sets": {
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "name": { "type": "string" },
                        "rr_type": { "type": "string" },
                        "ttl": { "type": "number" },
                        "value": { "type": "string" }
                    }
                }
            }
        }
    },
    "policy": "output.api_method=['set','get','delete'].includes(input.api_method); output.ip=true; output.utc_millis=true; output.user_agent=true; output.rr_sets=input.rr_sets.map(rr_set=>{ return {name:rr_set.name.startsWith('_acme-challenge')&&rr_set.name.endsWith('.'),value:true,ttl:rr_set.ttl<3600,rr_type:rr_set.rr_type==='TXT'}})",
    "input": {
        "api_method": "set",
        "ip": "::1",
        "utc_millis": 32141412414,
        "user_agent": "test",
        "rr_sets": [
            {
                "name": "_acme-challenge.y.gy.",
                "rr_type": "TXT",
                "ttl": 120,
                "value": "45znzbz6n u 56"
            },
            {
                "name": "x_acme-challenge.pektin.xyz.",
                "rr_type": "TXT",
                "ttl": 22120,
                "value": "45gv6556b546n"
            },
            {
                "name": "_acme-challenge.pektin.xyz.",
                "rr_type": "A",
                "ttl": 120,
                "value": "1.1.1.1"
            }
        ]
    }
}
